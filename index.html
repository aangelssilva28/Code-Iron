<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Code and Iron</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg-main: #000000;
      --bg-card: #141414;
      --bg-inner: #1a1a1a;
      --accent-blue: #007aff;
      --accent-red: #d93030;
      --accent-text: #ffb74d;
      --text-main: #ffffff;
      --text-muted: #cccccc;
      --input-bg: #000000;
      --input-border: #333333;
      --menu-bg: #181818;
      --menu-border: #333333;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      background-color: var(--bg-main);
      color: var(--text-main);
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }

    /* Page wrapper */
    .page {
      min-height: 100vh;
      padding: 16px 16px 32px 16px;
    }

    /* Header */
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .title {
      font-size: 32px;
      font-weight: 800;
    }

    .menu-button {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      border: 1px solid #333;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #111;
    }

    .menu-icon-line {
      width: 18px;
      height: 2px;
      background-color: #fff;
      margin: 2px 0;
      border-radius: 2px;
    }

    /* Menu dropdown */
    .menu-container {
      position: relative;
    }

    .menu-panel {
      position: absolute;
      right: 0;
      top: 50px;
      background-color: var(--menu-bg);
      border-radius: 12px;
      border: 1px solid var(--menu-border);
      width: 260px;
      overflow: hidden;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.7);
      display: none;
      z-index: 20;
    }

    .menu-panel.open {
      display: block;
    }

    .menu-item {
      padding: 16px;
      border-bottom: 1px solid #222;
      font-size: 16px;
    }

    .menu-item:last-child {
      border-bottom: none;
    }

    .menu-item:active {
      background-color: #222;
    }

    /* Tabs: Home vs Saved Workouts */
    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 14px;
    }

    .tab-button {
      flex: 1;
      padding: 10px 0;
      border-radius: 999px;
      border: 1px solid #333;
      background-color: #050505;
      color: #aaa;
      font-size: 14px;
      font-weight: 500;
    }

    .tab-button.active {
      background-color: var(--accent-blue);
      color: #fff;
      border-color: var(--accent-blue);
    }

    /* Card container (same style for both pages) */
    .card {
      background-color: var(--bg-card);
      border-radius: 24px;
      padding: 18px 16px 20px 16px;
      box-shadow: 0 0 4px rgba(255, 255, 255, 0.04);
      margin-bottom: 16px;
    }

    .card-title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 6px;
    }

    .card-subtitle {
      font-size: 14px;
      color: var(--text-muted);
      margin-bottom: 14px;
    }

    /* Workout name input (same style as before) */
    .workout-name-input {
      width: 100%;
      padding: 10px 12px;
      border-radius: 12px;
      background-color: var(--input-bg);
      border: 1px solid var(--input-border);
      color: #fff;
      font-size: 16px;
    }

    .remove-workout-btn {
      width: 100%;
      margin-top: 14px;
      padding: 14px 0;
      border-radius: 999px;
      border: none;
      background-color: var(--accent-red);
      color: #fff;
      font-size: 18px;
      font-weight: 600;
    }

    /* Inner set box */
    .set-box {
      background-color: var(--bg-inner);
      border-radius: 18px;
      padding: 14px 12px 16px 12px;
      margin-top: 16px;
    }

    .set-label {
      font-size: 16px;
      font-weight: 700;
      color: var(--accent-text);
      margin-bottom: 10px;
    }

    .row {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 10px;
    }

    .input-box {
      flex: 1;
    }

    .input-label {
      font-size: 14px;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .input-field {
      width: 100%;
      padding: 8px 10px;
      border-radius: 10px;
      background-color: var(--input-bg);
      border: 1px solid var(--input-border);
      color: #fff;
      font-size: 16px;
    }

    .remove-set-btn {
      width: 100%;
      margin-top: 10px;
      padding: 12px 0;
      border-radius: 999px;
      border: none;
      background-color: #8b1f1f;
      color: #fff;
      font-size: 17px;
      font-weight: 600;
    }

    .add-set-btn {
      width: 100%;
      margin-top: 16px;
      padding: 14px 0;
      border-radius: 999px;
      border: none;
      background-color: var(--accent-blue);
      color: #fff;
      font-size: 18px;
      font-weight: 600;
    }

    .primary-bottom-btn {
      width: 100%;
      margin-top: 22px;
      padding: 14px 0;
      border-radius: 999px;
      border: none;
      background-color: var(--accent-blue);
      color: #fff;
      font-size: 18px;
      font-weight: 600;
    }

    .page-hidden {
      display: none;
    }

    /* Simple dialog for "Workouts page coming soon" (keep for now as generic modal if needed) */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 30;
    }

    .modal {
      background-color: #181818;
      border-radius: 16px;
      padding: 18px 18px 12px 18px;
      width: 90%;
      max-width: 380px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.8);
    }

    .modal-text {
      font-size: 17px;
      margin-bottom: 12px;
    }

    .modal-footer {
      display: flex;
      justify-content: flex-end;
    }

    .modal-close-btn {
      border: none;
      background: none;
      color: #4da3ff;
      font-size: 16px;
      font-weight: 600;
      padding: 6px 0 2px 0;
    }

    @media (min-width: 768px) {
      .page {
        max-width: 480px;
        margin: 0 auto;
      }
    }
  </style>
</head>

<body>
  <div class="page">
    <!-- HEADER -->
    <div class="header">
      <div class="title">Code and Iron</div>

      <div class="menu-container">
        <button class="menu-button" id="menuBtn" aria-label="Menu">
          <div>
            <div class="menu-icon-line"></div>
            <div class="menu-icon-line"></div>
            <div class="menu-icon-line"></div>
          </div>
        </button>

        <div class="menu-panel" id="menuPanel">
          <div class="menu-item" data-menu="workouts">Workouts</div>
          <div class="menu-item">Option 2</div>
          <div class="menu-item">Option 3</div>
          <div class="menu-item">Option 4</div>
        </div>
      </div>
    </div>

    <!-- TABS -->
    <div class="tabs">
      <button class="tab-button active" id="tabHome">Today</button>
      <button class="tab-button" id="tabSaved">Saved workouts</button>
    </div>

    <!-- HOME PAGE (Todayâ€™s workout logger) -->
    <div id="homePage">
      <div class="card">
        <div class="card-title">Today&apos;s workout</div>

        <input
          id="todayWorkoutName"
          class="workout-name-input"
          placeholder="Enter workout name"
        />

        <button class="remove-workout-btn" id="homeRemoveWorkout">
          Remove workout
        </button>

        <div id="homeSetsContainer"></div>

        <button class="add-set-btn" id="homeAddSetBtn">Add set</button>
      </div>

      <button class="primary-bottom-btn" id="homeAddWorkoutBtn">
        Add workout
      </button>
    </div>

    <!-- SAVED WORKOUTS PAGE -->
    <div id="savedPage" class="page-hidden">
      <div class="card">
        <div class="card-title">Saved workouts</div>
        <div class="card-subtitle">
          Build workout templates you can re-use later.
        </div>

        <input
          id="savedWorkoutName"
          class="workout-name-input"
          placeholder="Template name (e.g. Push Day)"
        />

        <button class="remove-workout-btn" id="savedRemoveWorkout">
          Reset template
        </button>

        <div id="savedSetsContainer"></div>

        <button class="add-set-btn" id="savedAddSetBtn">Add set</button>
      </div>

      <button class="primary-bottom-btn" id="savedAddWorkoutBtn">
        Save workout template
      </button>
    </div>
  </div>

  <!-- Modal placeholder (not used heavily yet, but kept for future) -->
  <div id="modalRoot" style="display:none;"></div>

  <script>
    /****************
     * Menu handling
     ****************/
    const menuBtn = document.getElementById('menuBtn');
    const menuPanel = document.getElementById('menuPanel');

    menuBtn.addEventListener('click', () => {
      menuPanel.classList.toggle('open');
    });

    document.addEventListener('click', (e) => {
      if (!menuPanel.contains(e.target) && !menuBtn.contains(e.target)) {
        menuPanel.classList.remove('open');
      }
    });

    // Menu item: Workouts -> switch to Saved workouts tab
    menuPanel
      .querySelector('[data-menu="workouts"]')
      .addEventListener('click', () => {
        switchTab('saved');
        menuPanel.classList.remove('open');
      });

    /****************
     * Tabs
     ****************/
    const tabHome = document.getElementById('tabHome');
    const tabSaved = document.getElementById('tabSaved');
    const homePage = document.getElementById('homePage');
    const savedPage = document.getElementById('savedPage');

    function switchTab(tab) {
      const isHome = tab === 'home';
      tabHome.classList.toggle('active', isHome);
      tabSaved.classList.toggle('active', !isHome);
      homePage.classList.toggle('page-hidden', !isHome);
      savedPage.classList.toggle('page-hidden', isHome);
    }

    tabHome.addEventListener('click', () => switchTab('home'));
    tabSaved.addEventListener('click', () => switchTab('saved'));

    /****************
     * Set helpers
     ****************/
    let homeSetCounter = 0;
    let savedSetCounter = 0;

    function createSetElement(context, index) {
      // context: 'home' or 'saved'
      const div = document.createElement('div');
      div.className = 'set-box';

      const label = document.createElement('div');
      label.className = 'set-label';
      label.textContent = `Set ${index}`;
      div.appendChild(label);

      const row = document.createElement('div');
      row.className = 'row';

      const weightBox = document.createElement('div');
      weightBox.className = 'input-box';
      const weightLabel = document.createElement('div');
      weightLabel.className = 'input-label';
      weightLabel.textContent = 'Weight';
      const weightInput = document.createElement('input');
      weightInput.className = 'input-field';
      weightInput.placeholder = 'lbs';
      weightInput.inputMode = 'decimal';
      weightBox.appendChild(weightLabel);
      weightBox.appendChild(weightInput);

      const repsBox = document.createElement('div');
      repsBox.className = 'input-box';
      const repsLabel = document.createElement('div');
      repsLabel.className = 'input-label';
      repsLabel.textContent = 'Reps';
      const repsInput = document.createElement('input');
      repsInput.className = 'input-field';
      repsInput.placeholder = '0';
      repsInput.inputMode = 'numeric';
      repsBox.appendChild(repsLabel);
      repsBox.appendChild(repsInput);

      row.appendChild(weightBox);
      row.appendChild(repsBox);
      div.appendChild(row);

      const removeBtn = document.createElement('button');
      removeBtn.className = 'remove-set-btn';
      removeBtn.textContent = 'Remove set';

      removeBtn.addEventListener('click', () => {
        div.remove();
        renumberSets(context);
      });

      div.appendChild(removeBtn);
      return div;
    }

    function renumberSets(context) {
      const containerId =
        context === 'home' ? 'homeSetsContainer' : 'savedSetsContainer';
      const container = document.getElementById(containerId);
      [...container.querySelectorAll('.set-box')].forEach((box, idx) => {
        const label = box.querySelector('.set-label');
        if (label) label.textContent = `Set ${idx + 1}`;
      });
    }

    /****************
     * HOME PAGE LOGIC
     ****************/
    const homeSetsContainer = document.getElementById('homeSetsContainer');
    const homeAddSetBtn = document.getElementById('homeAddSetBtn');
    const homeRemoveWorkoutBtn = document.getElementById('homeRemoveWorkout');
    const homeAddWorkoutBtn = document.getElementById('homeAddWorkoutBtn');
    const todayWorkoutNameInput = document.getElementById('todayWorkoutName');

    homeAddSetBtn.addEventListener('click', () => {
      homeSetCounter += 1;
      const setEl = createSetElement('home', homeSetCounter);
      homeSetsContainer.appendChild(setEl);
    });

    homeRemoveWorkoutBtn.addEventListener('click', () => {
      todayWorkoutNameInput.value = '';
      homeSetsContainer.innerHTML = '';
      homeSetCounter = 0;
    });

    homeAddWorkoutBtn.addEventListener('click', () => {
      // For now this just "starts a new workout" like before:
      todayWorkoutNameInput.value = '';
      homeSetsContainer.innerHTML = '';
      homeSetCounter = 0;
      alert('New workout started.');
    });

    /****************
     * SAVED WORKOUTS LOGIC
     ****************/
    const savedSetsContainer = document.getElementById('savedSetsContainer');
    const savedAddSetBtn = document.getElementById('savedAddSetBtn');
    const savedRemoveWorkoutBtn = document.getElementById('savedRemoveWorkout');
    const savedAddWorkoutBtn = document.getElementById('savedAddWorkoutBtn');
    const savedWorkoutNameInput = document.getElementById('savedWorkoutName');

    const STORAGE_KEY = 'code_and_iron_templates_v1';

    function loadTemplates() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return [];
        return JSON.parse(raw);
      } catch (e) {
        return [];
      }
    }

    function saveTemplates(list) {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(list));
      } catch (e) {}
    }

    function resetSavedTemplateCard() {
      savedWorkoutNameInput.value = '';
      savedSetsContainer.innerHTML = '';
      savedSetCounter = 0;
    }

    savedAddSetBtn.addEventListener('click', () => {
      savedSetCounter += 1;
      const setEl = createSetElement('saved', savedSetCounter);
      savedSetsContainer.appendChild(setEl);
    });

    savedRemoveWorkoutBtn.addEventListener('click', () => {
      resetSavedTemplateCard();
    });

    savedAddWorkoutBtn.addEventListener('click', () => {
      const name = savedWorkoutNameInput.value.trim();
      if (!name) {
        alert('Give this template a name first.');
        return;
      }

      const sets = [];
      savedSetsContainer.querySelectorAll('.set-box').forEach((box) => {
        const inputs = box.querySelectorAll('.input-field');
        if (inputs.length === 2) {
          sets.push({
            weight: inputs[0].value,
            reps: inputs[1].value,
          });
        }
      });

      if (sets.length === 0) {
        alert('Add at least one set to this template.');
        return;
      }

      const templates = loadTemplates();
      // If template with same name exists, overwrite.
      const existingIdx = templates.findIndex((t) => t.name === name);
      const template = { name, sets };
      if (existingIdx >= 0) {
        templates[existingIdx] = template;
      } else {
        templates.push(template);
      }
      saveTemplates(templates);

      alert('Template saved!');
      resetSavedTemplateCard();
    });

    /****************
     * INIT
     ****************/
    function init() {
      // Start each page with one blank set
      homeAddSetBtn.click();
      savedAddSetBtn.click();
    }

    init();
  </script>
</body>
</html>