<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Code and Iron</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>
/* ------------------ CUSTOM FONT ------------------ */
@font-face {
  font-family: "CodeAndIron";
  src: url("fonts/codeandiron.ttf") format("truetype");
  font-weight: normal;
  font-style: normal;
}

/* ------------------ COLOR + GLOBAL ------------------ */
:root {
  --bg: #000;
  --card: #121212;
  --card-inner: #1a1a1a;
  --text-main: #fff;
  --text-muted: #bbbbbb;
  --accent: #0a84ff;
  --danger: #d93030;
  --radius-card: 24px;
  --radius-pill: 999px;
  --shadow-soft: 0 10px 30px rgba(0,0,0,0.7);
}

* { box-sizing: border-box; }

body {
  margin: 0;
  padding: 0;
  background: var(--bg);
  color: var(--text-main);
  font-family: "CodeAndIron", -apple-system, BlinkMacSystemFont, sans-serif;
}

/* ------------------ WRAPPER ------------------ */
.app-wrapper {
  min-height: 100vh;
  padding: 12px;
  display: flex;
  flex-direction: column;
}

/* ------------------ HEADER ------------------ */
.app-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin: 6px 4px 18px;
}

.app-header h1 {
  font-size: 38px;
  margin: 0;
}

/* menu button square */
.menu-button {
  width: 44px;
  height: 44px;
  background: #111;
  border: 1px solid #333;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.menu-icon {
  width: 18px;
  height: 18px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.menu-icon span {
  height: 3px;
  background: white;
  border-radius: 999px;
}

/* ------------------ MENU DROPDOWN ------------------ */
.menu-dropdown {
  position: absolute;
  right: 16px;
  top: 64px;
  background: #111;
  border-radius: 16px;
  box-shadow: var(--shadow-soft);
  opacity: 0;
  pointer-events: none;
  transform: translateY(-8px);
  transition: 0.2s ease;
  min-width: 210px;
}

.menu-dropdown.open {
  opacity: 1;
  pointer-events: auto;
  transform: translateY(0);
}

.menu-item {
  padding: 14px 18px;
  border-bottom: 1px solid #222;
  font-size: 18px;
}

.menu-item:last-child { border-bottom: none; }

/* ------------------ SCREENS ------------------ */
.screen { display: none; }
.screen.active { display: block; }

/* ------------------ CARD ------------------ */
.card {
  background: var(--card);
  padding: 18px 16px 24px;
  border-radius: var(--radius-card);
  max-width: 480px;
  margin: 0 auto;
  box-shadow: var(--shadow-soft);
}

/* ------------------ BUTTONS ------------------ */
.primary-btn {
  width: 100%;
  background: var(--accent);
  padding: 12px;
  color: white;
  border: none;
  border-radius: var(--radius-pill);
  font-size: 18px;
  margin-top: 10px;
}

.danger-btn {
  width: 100%;
  background: var(--danger);
  padding: 12px;
  border: none;
  color: white;
  border-radius: var(--radius-pill);
  font-size: 17px;
  margin-top: 6px;
}

/* ------------------ EXERCISE CARD ------------------ */
.exercise-card {
  background: var(--card-inner);
  border: 1px solid #222;
  padding: 16px;
  border-radius: 20px;
  margin-bottom: 12px;
}

.exercise-card input {
  width: 100%;
  background: black;
  border: 1px solid #444;
  padding: 10px;
  color: white;
  border-radius: 10px;
}

/* set box */
.set-box {
  background: #151515;
  border: 1px solid #262626;
  border-radius: 16px;
  padding: 10px;
  margin-top: 6px;
}

.set-header {
  font-size: 18px;
  margin-bottom: 8px;
}

.set-row {
  display: flex;
  gap: 10px;
}

.set-col label {
  font-size: 14px;
  margin-bottom: 4px;
  color: #ccc;
}

.set-input {
  width: 100%;
  padding: 8px;
  border-radius: 12px;
  background: #000;
  border: 1px solid #333;
  color: white;
}

/* ------------------ SAVED ROUTINES ------------------ */
.saved-item {
  background: #151515;
  border: 1px solid #262626;
  padding: 12px;
  border-radius: 14px;
  margin-bottom: 10px;
  display: flex;
  justify-content: space-between;
}

.small-btn {
  padding: 6px 10px;
  border-radius: 999px;
  color: white;
  border: none;
  font-size: 14px;
}

.small-btn.load { background: #09c372; }
.small-btn.open { background: #0a84ff; }
.small-btn.delete { background: #802121; }

.open-panel {
  display: none;
  background: #111;
  padding: 14px;
  border-radius: 16px;
  margin-top: 8px;
}

.open-panel.open { display: block; }

</style>
</head>

<body>
<div class="app-wrapper">

  <!-- HEADER -->
  <header class="app-header">
    <h1>Code and Iron</h1>
    <button class="menu-button" id="menuButton">
      <div class="menu-icon">
        <span></span><span></span><span></span>
      </div>
    </button>
  </header>

  <!-- MENU -->
  <div class="menu-dropdown" id="menuDropdown">
    <div class="menu-item" data-nav="routines">Routines</div>
  </div>

  <!-- HOME SCREEN -->
  <main id="homeScreen" class="screen active">
    <section class="card">
      <div id="exerciseContainer"></div>
      <button id="addExerciseBtn" class="primary-btn">Add Exercise</button>
    </section>
  </main>

  <!-- ROUTINES SCREEN -->
  <main id="routinesScreen" class="screen">
    <section class="card">
      <h2 class="card-title">Routines</h2>

      <div class="input-group">
        <input id="routineNameInput" class="text-input" placeholder="Routine name">
      </div>

      <button id="saveRoutineBtn" class="primary-btn">Create</button>

      <div id="savedRoutinesList"></div>

      <div class="link-back" id="backToHome" style="margin-top:18px;font-size:16px;color:#888;">
        ‚Üê Back
      </div>
    </section>
  </main>

</div>

<script>
/* ------------------ BASIC NAV ------------------ */
const menuButton = document.getElementById("menuButton");
const menuDropdown = document.getElementById("menuDropdown");
const homeScreen = document.getElementById("homeScreen");
const routinesScreen = document.getElementById("routinesScreen");

menuButton.onclick = () => menuDropdown.classList.toggle("open");

document.addEventListener("click", (e) => {
  if (!menuButton.contains(e.target) && !menuDropdown.contains(e.target)) {
    menuDropdown.classList.remove("open");
  }
});

document.querySelector("[data-nav='routines']").onclick = () => {
  homeScreen.classList.remove("active");
  routinesScreen.classList.add("active");
  menuDropdown.classList.remove("open");
};

document.getElementById("backToHome").onclick = () => {
  routinesScreen.classList.remove("active");
  homeScreen.classList.add("active");
};

/* ------------------ EXERCISE CARD CREATOR ------------------ */

function createExerciseCard(parent, data) {
  const card = document.createElement("div");
  card.className = "exercise-card";

  const name = document.createElement("input");
  name.placeholder = "Exercise name";
  name.value = data?.name || "";
  card.appendChild(name);

  const setsWrap = document.createElement("div");
  card.appendChild(setsWrap);

  function addSet(setData) {
    const setBox = document.createElement("div");
    setBox.className = "set-box";

    const header = document.createElement("div");
    header.className = "set-header";
    header.textContent = "Set";
    setBox.appendChild(header);

    const row = document.createElement("div");
    row.className = "set-row";

    const colW = document.createElement("div");
    colW.className = "set-col";
    colW.innerHTML = `<label>Weight</label>`;
    const inW = document.createElement("input");
    inW.className = "set-input";
    inW.placeholder = "lbs";
    inW.value = setData?.weight || "";
    colW.appendChild(inW);

    const colR = document.createElement("div");
    colR.className = "set-col";
    colR.innerHTML = `<label>Reps</label>`;
    const inR = document.createElement("input");
    inR.className = "set-input";
    inR.placeholder = "0";
    inR.value = setData?.reps || "";
    colR.appendChild(inR);

    row.appendChild(colW);
    row.appendChild(colR);
    setBox.appendChild(row);

    const remove = document.createElement("button");
    remove.className = "danger-btn";
    remove.textContent = "Remove set";
    remove.onclick = () => setBox.remove();

    setBox.appendChild(remove);

    setsWrap.appendChild(setBox);
  }

  (data?.sets || [{weight:"", reps:""}]).forEach(s => addSet(s));

  const addSetBtn = document.createElement("button");
  addSetBtn.className = "primary-btn";
  addSetBtn.textContent = "Add set";
  addSetBtn.onclick = () => addSet();
  card.appendChild(addSetBtn);

  parent.appendChild(card);
}

/* HOME EXERCISES */
const exerciseContainer = document.getElementById("exerciseContainer");
document.getElementById("addExerciseBtn").onclick = () => {
  createExerciseCard(exerciseContainer);
};

/* ------------------ ROUTINES SAVE/LOAD ------------------ */
const routineNameInput = document.getElementById("routineNameInput");
const saveRoutineBtn = document.getElementById("saveRoutineBtn");
const savedRoutinesList = document.getElementById("savedRoutinesList");

const STORAGE_KEY = "CodeAndIron_Routines_v1";
let routines = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");

function saveRoutines() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(routines));
}

function getHomeLayout() {
  const cards = exerciseContainer.querySelectorAll(".exercise-card");
  const result = [];

  cards.forEach(card => {
    const name = card.querySelector("input").value;
    const sets = [...card.querySelectorAll(".set-box")].map(box => {
      const inputs = box.querySelectorAll("input");
      return { weight: inputs[0].value, reps: inputs[1].value };
    });
    result.push({ name, sets });
  });

  return result;
}

function applyRoutineToHome(data) {
  exerciseContainer.innerHTML = "";
  data.forEach(ex => createExerciseCard(exerciseContainer, ex));
}

function renderRoutines() {
  savedRoutinesList.innerHTML = "";
  routines.forEach((r, idx) => {
    const row = document.createElement("div");
    row.className = "saved-item";

    const name = document.createElement("div");
    name.textContent = r.name;
    row.appendChild(name);

    const btns = document.createElement("div");
    btns.style.display = "flex";
    btns.style.gap = "6px";

    const load = document.createElement("button");
    load.className = "small-btn load";
    load.textContent = "Load";
    load.onclick = () => {
      applyRoutineToHome(r.exercises);
      routinesScreen.classList.remove("active");
      homeScreen.classList.add("active");
    };

    const del = document.createElement("button");
    del.className = "small-btn delete";
    del.textContent = "Delete";
    del.onclick = () => {
      routines.splice(idx, 1);
      saveRoutines();
      renderRoutines();
    };

    btns.appendChild(load);
    btns.appendChild(del);

    row.appendChild(btns);
    savedRoutinesList.appendChild(row);
  });
}

saveRoutineBtn.onclick = () => {
  const name = routineNameInput.value.trim();
  if (!name) return alert("Name your routine first!");

  const data = getHomeLayout();
  routines.push({ name, exercises: data });
  saveRoutines();
  renderRoutines();
  routineNameInput.value = "";
};

renderRoutines();

/* INIT */
createExerciseCard(exerciseContainer);

</script>
</body>
</html>